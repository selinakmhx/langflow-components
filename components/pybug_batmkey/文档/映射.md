# 小红书笔记搜索v2接口字段映射文档

## 接口基本信息
- **接口地址**: `http://api.batmkey.cn:8000/api/v3`
- **路由路径**: `/xhs/search`
- **请求方式**: POST

## 字段映射关系

### 1. 基础控制参数
| 需求字段 | JSON字段路径 | 说明 | 示例值 |
|---------|-------------|------|--------|
| 是否获取作者详细信息 | 无对应字段 | 需要额外API调用 | - |

### 2. 笔记基础信息
| 需求字段 | JSON字段路径 | 类型 | 示例值 |
|---------|-------------|------|--------|
| 标题 | `note.title` | string | "牛马人奖励自己的项链" |
| 点赞数 | `note.liked_count` | int | 89 |
| 评论数 | `note.comments_count` | int | 53 |
| 收藏数 | `note.collected_count` | int | 27 |
| 好看数 | `note.nice_count` | int | 0 |
| 分享数 | `note.shared_count` | int | 4 |
| 笔记类型 | `note.type` | string | "normal"（图文）, "video"（视频） |
| 笔记id | `note.id` | string | "690d8422000000000301d604" |
| 笔记链接 | 需拼接: `https://www.xiaohongshu.com/explore/` + `note.id` | string | `https://www.xiaohongshu.com/explore/690d8422000000000301d604` |
| 笔记正文 | `note.desc` | string | "牛马人也需要动力..." |
| 发布时间 | `note.timestamp` | int | 1762493474（需转换为人能看懂的时间格式） |

### 3. 多媒体信息（支持多个）

#### 图片信息（多个）
| 需求字段 | JSON字段路径 | 类型 | 说明 |
|---------|-------------|------|------|
| 封面图链接 | `note.images_list[0].url` | string | 第一张图片URL |
| 图片链接列表 | `note.images_list[*].url` | array | 所有图片URL数组 |
| 图片详细信息 | `note.images_list[*]` | array | 包含所有图片元数据 |

**图片对象结构**:
```json
{
  "fileid": "notes_pre_post/1040g3k831oishij606705q6vkordp7v092nrou8",
  "height": 4032,
  "width": 3024,
  "url": "图片URL",
  "live_photo": {...}, // 动态照片信息
  "need_load_original_image": false
}
```

#### 视频信息（多个）
| 需求字段 | JSON字段路径 | 类型 | 说明 |
|---------|-------------|------|------|
| 视频链接 | `note.images_list[*].live_photo.media.streams[0].master_url` | string | 主视频流URL（通常取第一个） |
| 视频ID | `note.images_list[*].live_photo.media.video_id` | int | 137656122691830910 |
| 视频元数据 | `note.images_list[*].live_photo.media` | object | 视频详细信息 |

**视频流对象结构**:
```json
{
  "master_url": "http://sns-video-hs.xhscdn.com/stream/...",
  "video_bitrate": 2838317,
  "video_codec": "hevc",
  "video_duration": 2949,
  "height": 1440,
  "width": 1080,
  "stream_desc": "livephoto_r256_1080p_16_ios"
}
```

### 4. 作者信息（基础）
| 需求字段 | JSON字段路径 | 类型 | 示例值 |
|---------|-------------|------|--------|
| 作者昵称 | `note.user.nickname` | string | "一颗丸子头" |
| 小红书号 | `note.user.red_id` | string | "18906303247" |
| 是否官方认证 | `note.user.red_official_verified` | boolean | false |
| 作者头像 | `note.user.images` | string | "https://sns-avatar-qc.xhscdn.com/avatar/..." |
| 作者ID | `note.user.userid` | string | "68dfa6360000000037009fe0" |

### 5. 作者详细信息（需要额外API）
**注意：当前接口不包含以下字段，需要额外调用用户详情接口**

| 需求字段 | JSON字段路径 | 说明 |
|---------|-------------|------|
| 作者粉丝数 | 无 | 需要用户详情接口 |
| 作者获赞与收藏数 | 无 | 需要用户详情接口 |
| 作者简介 | 无 | 需要用户详情接口 |
| 作者主页链接 | 需拼接: `https://www.xiaohongshu.com/user/profile/` + `note.user.userid` | string | `https://www.xiaohongshu.com/user/profile/68dfa6360000000037009fe0` |

### 6. 标签信息
| 需求字段 | JSON字段路径 | 类型 | 说明 |
|---------|-------------|------|------|
| 笔记tag | `note.tag_info` | object | 标签信息对象 |
| 标签标题 | `note.tag_info.title` | string | 标签标题 |
| 标签类型 | `note.tag_info.type` | string | 标签类型 |

## 特殊处理说明

1. **多个图片/视频处理**: 使用数组索引遍历 `note.images_list[*]`
2. **时间戳转换**: `note.timestamp` 需要除以1000转换为秒级时间戳
3. **URL拼接**: 笔记链接和作者主页链接需要手动拼接
4. **用户详情**: 需要额外调用用户详情接口获取粉丝数等数据
5. **编码处理**: 文本字段可能包含Unicode转义字符，需要解码

## 请求参数映射
| 前端参数 | API参数 | 值映射 |
|---------|---------|--------|
| 排序方式 | sort | 0=综合, 1=最新, 2=最热 |
| 笔记类型 | note_type | 0=全部, 1=视频, 2=图文 |
| 页码 | page | 直接传递 |
| 序列号 | bydev | 从1开始，每页+1 |